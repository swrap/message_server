{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static "message_app/message.css" %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <link rel="stylesheet" href="message.css">
    <title>Message</title>
    <script type="text/javascript">
            var colorPalettes = [
                {"verylight":"#FDFDFD","light":"#D48D8D","primary":"#AA3939","dark":"#800000","verydark":"#570000"},
                {"verylight":"#FDFDFD","light":"#D4AE8D","primary":"#AA6D39","dark":"#803B00","verydark":"#572800"},
                {"verylight":"#D5D5D5","light":"#83B277","primary":"#448F30","dark":"#176C00","verydark":"#0F4900"},
                {"verylight":"#A3A3A3","light":"#5E7688","primary":"#29506D","dark":"#053153","verydark":"#002038"},
                {"verylight":"#B1B1B1","light":"#6A6A94","primary":"#343477","dark":"#0D0D5A","verydark":"#00003D"},
                {"verylight":"#C7C7C7","light":"#A76F91","primary":"#862D63","dark":"#65003D","verydark":"#44002A"},
            ]
    </script>
</head>
    <body>
        <div class="hnav-bar">
            <div class="hnav-item title">
                ROOFmessage
            </div>
            <div class="hnav-item">
                <img src="https://scontent.xx.fbcdn.net/v/t1.0-9/12243031_10206824806650637_6944867127296031915_n.jpg?oh=7133519ac1ede89025bec94c43663d46&oe=580BD49A"><span class='hnav-name'>Aaron<br>Sorrin</span>
            </div>
            <div class="hnav-item">
                <img src="https://scontent.xx.fbcdn.net/v/t1.0-9/11891080_10206558314452797_6325493572671371248_n.jpg?oh=4291fb52e643cb994cdc9a06b6e62ede&oe=580E9455"><span class='hnav-name'>Jesse<br>Saran</span>
            </div>
            <div class="hnav-item">
                <img src="https://scontent.xx.fbcdn.net/v/t1.0-9/12631544_967528683315809_7395764061206692398_n.jpg?oh=6d19367a63afc2b8c6a767e07ef221a4&oe=57CB5689"><span class='hnav-name'>Chris<br>Klebanski</span>
            </div>
            <div class="hnav-item">
                <img src="https://scontent.xx.fbcdn.net/v/t1.0-9/12794376_1094029560628652_8876178797868034808_n.jpg?oh=fae66f0a4060aa0df68f84b149a7f6be&oe=57DC83A0"><span class='hnav-name'>Matthew<br>Graham</span>
            </div>
        </div>
        <div class="message-container">
            <div class="vnav-item" onclick="window.location.replace('/settings/')">Settings</div>
            <input type="text" style="float:right; margin-right:3px; margin-top:-33px;">
        </div>
        {% csrf_token %}
        <table style="border-color:white;width:25%;">
            <tr>
                <td style="text-align: center;">
                    <h3>Messages</h3>
                </td>
            </tr>
            <tr>
                <td>
                    <a href="{% url 'MessageApp:logout' %}"><input class="buttons" type="submit" value="Logout"/></a>
                </td>
            </tr>
            <tr>
                <td>
                    <a href="{% url 'MessageApp:settings' %}"><input class="buttons" method="get" type="submit" value="Settings"/></a>
                </td>
            </tr>
            <tr>
                <td style="text-align: center; width: 100%;">
                    <select class="tab_menus" id="list_selected" style="width: 100%;">
                        <option selected>Contacts</option>
                        <option>Conversations</option>
                    </select>
                    <select class="tab_menus" id="all_or_none" style="width: 100%;">
                        <option selected>My Contacts</option>
                        <option>All Users</option>
                    </select>

                    <select id="scroll_data" size="4" multiple style="width: 100%;">

                    </select>
                </td>
            </tr>
        </table>

    <script>
        //makes it so ready function is fired on back button
        history.navigationMode = 'compatible';

        $(document).ready(function() {
            //in event that back button is hit reload data
            //get the selection list
            var selected_list = $('#scroll_data');
            //clear the selection list
            selected_list.empty()
        });

        $(".tab_menus").change(function() {

            //get the selection list
            var selected_list = $('#scroll_data');
            //clear the selection list
            selected_list.empty()

            if($( "#list_selected option:selected" ).text() == "Contacts") {

                $("#all_or_none").show()

                if($( "#all_or_none option:selected" ).text() == "My Contacts")
                {
                    //make the query for the data
                    jQuery.ajax({
                        url: '{% url 'MessageApp:user_contacts' %}',
                        type: 'get',
                        dataType: 'json',
                        success: function (data) {
                            //success iterate throuh the data and put into the contacts
                            $.each(data, function(i, item){
                                console.log("HERE");
                                selected_list.append($("<option></option>").val(this).html(item.username));
                            });
                            },
                        failure: function (data) {
                            selected_list.append($("<option></option>").val(this).html("Unable to load"));
                        }
                    });
                }
                else
                {
                    //make the query for the data
                    jQuery.ajax({
                        url: '{% url 'MessageApp:all_contacts' %}',
                        type: 'get',
                        dataType: 'json',
                        success: function (data) {
                            //success iterate throuh the data and put into the contacts
                            $.each(data, function(i, item){
                                console.log("no here");
                                selected_list.append($("<option></option>").val(this).html(item.username));
                            });
                            },
                        failure: function (data) {
                            selected_list.append($("<option></option>").val(this).html("Unable to load"));
                        }
                    });
                }
            }
            else{
                $("#all_or_none").hide()
            }
          });
        var body = document.getElementsByTagName("body");
        var hnav_bar = document.getElementsByClassName("hnav-bar");
        var hnav_item = document.getElementsByClassName("hnav-item");
        var hnav_right_item = document.getElementsByClassName("hnav-right-item");

        var palNum = Math.floor(Math.random() * 6);
        var palette = colorPalettes[palNum];

        body[0].style.color = palette.verydark;
        hnav_bar[0].style.backgroundColor = palette.verydark;
        for(var i = 0; i < hnav_item.length; i++){
            hnav_item[i].style.backgroundColor = palette.light;
        }
        for(var i = 0; i < hnav_right_item.length; i++){
            hnav_right_item[i].style.backgroundColor = palette.primary;
        }

        var vnav_item = document.getElementsByClassName("vnav-item");
        vnav_item[0].style.backgroundColor = palette.primary;
    </script>
    </body>
</html>